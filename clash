# Name: Clash
# Author: Wuty-zju
# UpdateTime: 2024/7/26-PM/4:15
# URL: https://raw.githubusercontent.com/wutianyu1129/Quantumult-X/main/Clash

port: 7890
socks-port: 7891
allow-lan: false
mode: rule
log-level: info
external-controller: 127.0.0.1:9090
secret: ""
redir-port: 7892
tproxy-port: 7893
ipv6: true

dns:
  enable: true
  listen: 0.0.0.0:53
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - "*.lan"
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
    - https://cloudflare-dns.com/dns-query
    - https://dns.google/dns-query
  fallback:
    - 223.5.5.5
    - 2400:3200::1
    - 119.29.29.29
    - 2402:4e00::
    - 1.1.1.1
    - 2606:4700:4700::1111
    - 8.8.8.8
    - 2001:4860:4860::8888
  fallback-filter:
    geoip: true
    ipcidr:
      - 240.0.0.0/4

proxy-providers:
  西数·订阅:
    type: http
    path: ./profiles/proxies/westdata.yaml
    url: "https://api.wd-gold.com/sub?target=clash&emoji=true&udp=true&scv=true&new_name=true&filename=WD_Trojan&url=https%3A%2F%2Fwd-gold.com%2Fsubscribe%2Fknryqa-jsureaqn"
    interval: 1800
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

proxy-groups:  
# 节点
  - name: 全球·节点
    use:
      - 西数·订阅
    filter: "^(?=.*(.*))(?!.*((?i)邀请|返利|循环|官网|客服|网站|网址|获取|订阅|流量|到期|机场|下次|版本|官址|备用|恢复|过期|已用|联系|邮箱|工单|群|贩卖|通知|倒卖|防止|国内|🎮|TG|tg|\b(GAME|USE|USED|TOTAL|EXPIRE|EMAIL|Panel)\b)).*$"

  - name: 大陆·节点
    use:
      - 西数·订阅
    filter: "^(?=.*((?i)大陆|(\b(China)\b)))(?!.*((?i)校园)).*$"

  - name: 香港·节点
    use:
      - 西数·订阅
    filter: "^(?=.*((?i)🇭🇰|香港|(\b(HK|Hong)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"

  - name: 台湾·节点
    use:
      - 西数·订阅
    filter: "^(?=.*((?i)🇹🇼|台湾|(\b(TW|Tai|Taiwan)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"

  - name: 日本·节点
    use:
      - 西数·订阅
    filter: "^(?=.*((?i)🇯🇵|日本|川日|东京|大阪|泉日|埼玉|(\b(JP|Japan)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"

  - name: 韩国·节点
    use:
      - 西数·订阅
    filter: "^(?=.*((?i)🇰🇷|韩国|韓|首尔|(\b(KR|Korea)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"

  - name: 新国·节点
    use:
      - 西数·订阅
    filter: "^(?=.*((?i)🇸🇬|新加坡|狮|(\b(SG|Singapore)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"

  - name: 美国·节点
    use:
      - 西数·订阅
    filter: "^(?=.*((?i)🇺🇸|美国|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|(\b(US|United States)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"

  - name: 直连·节点
    use:
      - 西数·订阅
    filter: "^(?=.*((?i)直连|(\b(AD)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"

  - name: 拒绝·节点
    use:
      - 西数·订阅
    filter: "^(?=.*((?i)广告|(\b(AD)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"

# 场景
  - name: "全球·场景"
    type: select
    proxies:
      - "全球·策略"
  - name: "大陆·场景"
    type: select
    proxies:
      - "大陆·策略"
  - name: "香港·场景"
    type: select
    proxies:
      - "香港·策略"
  - name: "台湾·场景"
    type: select
    proxies:
      - "台湾·策略"
  - name: "日本·场景"
    type: select
    proxies:
      - "日本·策略"
  - name: "韩国·场景"
    type: select
    proxies:
      - "韩国·策略"
  - name: "新国·场景"
    type: select
    proxies:
      - "新国·策略"
  - name: "美国·场景"
    type: select
    proxies:
      - "美国·策略"
  - name: "直连·场景"
    type: select
    proxies:
      - "直连·策略"
  - name: "拒绝·场景"
    type: select
    proxies:
      - "拒绝·策略"

# 策略
  - name: "全球·策略"
    type: select
    proxies:
      - "全球·延时优选"
      - "全球·故障转移"
      - "全球·负载均衡"
      - "全球·手动选择"
  - name: "大陆·策略"
    type: select
    proxies:
      - "大陆·延时优选"
      - "大陆·故障转移"
      - "大陆·负载均衡"
      - "大陆·手动选择"
  - name: "香港·策略"
    type: select
    proxies:
      - "香港·延时优选"
      - "香港·故障转移"
      - "香港·负载均衡"
      - "香港·手动选择"
  - name: "台湾·策略"
    type: select
    proxies:
      - "台湾·延时优选"
      - "台湾·故障转移"
      - "台湾·负载均衡"
      - "台湾·手动选择"
  - name: "日本·策略"
    type: select
    proxies:
      - "日本·延时优选"
      - "日本·故障转移"
      - "日本·负载均衡"
      - "日本·手动选择"
  - name: "韩国·策略"
    type: select
    proxies:
      - "韩国·延时优选"
      - "韩国·故障转移"
      - "韩国·负载均衡"
      - "韩国·手动选择"
  - name: "新国·策略"
    type: select
    proxies:
      - "新国·延时优选"
      - "新国·故障转移"
      - "新国·负载均衡"
      - "新国·手动选择"
  - name: "美国·策略"
    type: select
    proxies:
      - "美国·延时优选"
      - "美国·故障转移"
      - "美国·负载均衡"
      - "美国·手动选择"
  - name: "直连·策略"
    type: select
    proxies:
      - "直连·延时优选"
      - "直连·故障转移"
      - "直连·负载均衡"
      - "直连·手动选择"
  - name: "拒绝·策略"
    type: select
    proxies:
      - "拒绝·延时优选"
      - "拒绝·故障转移"
      - "拒绝·负载均衡"
      - "拒绝·手动选择"

# 延时优选
  - name: "全球·延时优选"
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    proxies:
      - "全球·节点"
  - name: "大陆·延时优选"
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    proxies:
      - "大陆·节点"
  - name: "香港·延时优选"
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    proxies:
      - "香港·节点"
  - name: "台湾·延时优选"
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    proxies:
      - "台湾·节点"
  - name: "日本·延时优选"
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    proxies:
      - "日本·节点"
  - name: "韩国·延时优选"
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    proxies:
      - "韩国·节点"
  - name: "新国·延时优选"
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    proxies:
      - "新国·节点"
  - name: "美国·延时优选"
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    proxies:
      - "美国·节点"
  - name: "直连·延时优选"
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    proxies:
      - "直连·节点"
  - name: "拒绝·延时优选"
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    proxies:
      - "拒绝·节点"

# 故障转移
  - name: "全球·故障转移"
    type: fallback
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    max-fail: 3
    proxies:
      - "全球·节点"
  - name: "大陆·故障转移"
    type: fallback
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    max-fail: 3
    proxies:
      - "大陆·节点"
  - name: "香港·故障转移"
    type: fallback
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    max-fail: 3
    proxies:
      - "香港·节点"
 - name: "台湾·故障转移"
    type: fallback
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    max-fail: 3
    proxies:
      - "台湾·节点"
  - name: "日本·故障转移"
    type: fallback
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    max-fail: 3
    proxies:
      - "日本·节点"
  - name: "韩国·故障转移"
    type: fallback
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    max-fail: 3
    proxies:
      - "韩国·节点"
  - name: "新国·故障转移"
    type: fallback
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    max-fail: 3
    proxies:
      - "新国·节点"
  - name: "美国·故障转移"
    type: fallback
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    max-fail: 3
    proxies:
      - "美国·节点"
  - name: "直连·故障转移"
    type: fallback
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    max-fail: 3
    proxies:
      - "直连·节点"
  - name: "拒绝·故障转移"
    type: fallback
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    max-fail: 3
    proxies:
      - "拒绝·节点"

# 负载均衡
  - name: "全球·负载均衡"
    type: load-balance
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    strategy: round-robin
    proxies:
      - "全球·节点"
  - name: "大陆·负载均衡"
    type: load-balance
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    strategy: round-robin
    proxies:
      - "大陆·节点"
  - name: "香港·负载均衡"
    type: load-balance
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    strategy: round-robin
    proxies:
      - "香港·节点"
  - name: "台湾·负载均衡"
    type: load-balance
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    strategy: round-robin
    proxies:
      - "台湾·节点"
  - name: "日本·负载均衡"
    type: load-balance
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    strategy: round-robin
    proxies:
      - "日本·节点
  - name: "韩国·负载均衡"
    type: load-balance
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    strategy: round-robin
    proxies:
      - "韩国·节点"
  - name: "新国·负载均衡"
    type: load-balance
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    strategy: round-robin
    proxies:
      - "新国·节点"
  - name: "美国·负载均衡"
    type: load-balance
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    strategy: round-robin
    proxies:
      - "美国·节点"
  - name: "直连·负载均衡"
    type: load-balance
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    strategy: round-robin
    proxies:
      - "直连·节点"
  - name: "拒绝·负载均衡"
    type: load-balance
    url: http://www.apple.com/library/test/success.html
    interval: 10000
    strategy: round-robin
    proxies:
      - "拒绝·节点"

# 手动选择
  - name: "全球·手动选择"
    type: select
    proxies:
      - "全球·节点"
      - DIRECT
      - REJECT
  - name: "大陆·手动选择"
    type: select
    proxies:
      - "大陆·节点"
      - DIRECT
      - REJECT
  - name: "香港·手动选择"
    type: select
    proxies:
      - "香港·节点"
      - DIRECT
      - REJECT
  - name: "台湾·手动选择"
    type: select
    proxies:
      - "台湾·节点"
      - DIRECT
      - REJECT
  - name: "日本·手动选择"
    type: select
    proxies:
      - "日本·节点"
      - DIRECT
      - REJECT
  - name: "韩国·手动选择"
    type: select
    proxies:
      - "韩国·节点"
      - DIRECT
      - REJECT
  - name: "新国·手动选择"
    type: select
    proxies:
      - "新国·节点"
      - DIRECT
      - REJECT
  - name: "美国·手动选择"
    type: select
    proxies:
      - "美国·节点"
      - DIRECT
      - REJECT
  - name: "直连·手动选择"
    type: select
    proxies:
      - "直连·节点"
      - DIRECT
      - REJECT
  - name: "拒绝·手动选择"
    type: select
    proxies:
      - "拒绝·节点"
      - DIRECT
      - REJECT
